let txt_list = [["<sub>Analise Matematica I", 
             ["<s01>Lecture 1", 
               ["<s02>Ver aula"], 
               ["<s02>TPC"]], 
             ["<s01>Lecture 2", 
              ["<s02>Ler livro", 
                 ["<s03>Notas"]]]],

["<sub>Fundamentos da Programacao", 
   ["<s01>hehe"]],

["<sub>Algrebra"],

["<sub>Sistemas"],

["<sub>test", 
   ["<s01>rfgrg"]]]


function format(list) {
    formattedList = []
    for (let text in list) {
        let code = list[text].substring(0, 5)
        let newText = list[text].substring(5)
        if (code == "<s01>") {
            formattedList.push(`|_ ${newText}`)
        } else if (code == "<sub>") {
            formattedList.push(newText)
        } else {
            let num = parseInt(code.substring(2,4))
            formattedList.push(`${' '.repeat(num)} |_ ${newText}`)
        }
    }
    return formattedList.join('\n')
}

function flatten(task) {
    if (task.length === 0) {
        return task
    }

    if (typeof(task[0]) === 'object') {
        //console.log('1')
        //console.log(task[0])
        //console.log(task.slice(1))
        return task[0] + flatten(task.slice(1))
    }
    //console.log('2')
    //console.log(task[0])
    //console.log(task.slice(1))
    return [task[0]].concat(flatten(task.slice(1)))
}

function seeTasks() {
    let flattenTask = txt_list.flat(Infinity)
    let formatedTask = format(flattenTask)
    return formatedTask
}

function isOnTasks(task, listTask) {
    let flattenTasks = listTask.flat()
    return (flattenTasks.indexOf(task) != -1)
}

function addTask(content) {
    content = content.split('-')
    content[0] = `<sub>${content[0]}`
    for (let pos = 1; pos < content.length; pos++) {
        if (pos < 10) {
            content[pos] = `<s0${pos}>${content[pos]}`
        } else {
            content[pos] = `<s${pos}>${content[pos]}`
        }
    }
    let aux1 = txt_list
    for (let pos = 0; pos < content.length; pos++) {
        if (!isOnTasks(content[pos], aux1)) {
            aux1.push([content[pos]])
        }

        for (let i = 0; i < aux1.length; i++) {
            if (aux1[i][0] === content[pos]) {
                aux1 = aux1[i]
                break
            }
        }
    }

    console.log("Task(s) added successfuly.")
}

function delTask(content) {
    content = content.split('-')
    content[0] = `<sub>${content[0]}`
    for (let pos = 1; pos < content.length; pos++) {
        if (pos < 10) {
            content[pos] = `<s0${pos}>${content[pos]}`
        } else {
            content[pos] = `<s${pos}>${content[pos]}`
        }
    }
    let aux1 = JSON.parse(JSON.stringify(txt_list))

    for (let pos = 0; pos < content.length; pos++) {
        if (pos != content.length - 1) {
            for (let i = 0; i < aux1.length; i++) {
                if (aux1[i][0] == content[pos]) {
                    aux1 = aux1[i]
                    break
                } else {
                    for (let p = 0; p < aux1.length; i++) {
                        if (aux1[p][0] == content[pos]) {
                            break
                        }
                    }
                    aux1.splice(p, 1)
                }
            }
        }
    }

    txt_list = JSON.parse(JSON.stringify(aux1))

    console.log("Task(s) deleted successfuly.")
}


//console.log(seeTasks())
addTask('Algrebra-Prep Teste 1-Resumo-Integrais')
addTask('AMI-Prep Teste 1-Resumo-Integrais')
addTask('AMI-Prep Teste 1-Resumo-Eq diferenciais')
delTask('AMI-Prep Teste 1-Resumo-Eq diferenciais')
console.log(seeTasks())